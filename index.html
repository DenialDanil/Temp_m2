<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Temp_stat – живі дані</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body style="background:black; color:lime; font-family:Arial; text-align:center; margin:0;">

  <h1>Temp_stat — ESP32</h1>
  <div id="myDiv" style="width:95%; height:80vh; margin:auto;"></div>
  <h2 id="last"></h2>

  <script>
    const URL = "https://temp-stat2.onrender.com/data";   // ← ТВОЯ ТОЧНА АДРЕСА

    let x = [], temp = [], hum = [];

    Plotly.newPlot('myDiv', [{
      x: [], y: [], name: 'Температура °C', line: {color: 'red'}
    }, {
      x: [], y: [], name: 'Вологість %', yaxis: 'y2', line: {color: 'cyan'}
    }], {
      title: 'Живі дані з ESP32',
      paper_bgcolor: 'black',
      plot_bgcolor: 'black',
      font: {color: 'lime'},
      yaxis: {title: '°C', color: 'red'},
      yaxis2: {title: '%', overlaying: 'y, side:'right', color:'cyan'}
    });

    setInterval(async () => {
      try {
        const r = await fetch(URL + "?t=" + Date.now());
        const d = await r.json();

        const time = new Date().toLocaleTimeString();

        x.push(time);
        temp.push(d.temp);
        hum.push(d.hum);

        if (x.length > 100) { x.shift(); temp.shift(); hum.shift(); }

        Plotly.update('myDiv', {x:[x,x], y:[temp,hum]}, [0,1]);

        document.getElementById("last").innerHTML = 
          `Останнє: ${d.temp}°C | ${d.hum}% | ${time}`;

      } catch(e) { console.log("error"); }
    }, 7000);
  </script>

</body>
</html>
